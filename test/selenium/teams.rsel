include_partial 'fixtures'

open '/teams'
assert_text_not_present 'error'
assert_text_not_present 'Unknown action'

click_and_wait "css=a[href='/teams/2']"
assert_text_not_present 'error'
assert_text_not_present 'Unknown action'

include_partial 'admin_login'

open '/admin/teams'
assert_text_present "Enter part of a team's name"
type "name", "e"
submit_and_wait("search_form")

assert_text "warn", ""
assert_text "notice", ""

assert_table "teams", 1, 0, "Gentle Lovers"
assert_table "teams", 2, 0, "Team dFL"
assert_table "teams", 3, 0, "Vanilla"

assert_table "teams", 1, 1, "Gentile Lovers"
assert_table "teams", 2, 1, ""
assert_table "teams", 3, 1, "Vanilla Bicycles"

assert_checked "team_member_2"
assert_checked "team_member_4"
assert_checked "team_member_3"

click_and_wait "css=a[href='/results/team/4']"
assert_text_present "Team dFL"
assert_text_not_present 'error'
assert_text_not_present 'Unknown action'

open '/admin/teams'
click_and_wait "css=a[href='/admin/teams/3/edit']"
assert_text_present "Vanilla"
assert_text_not_present 'error'
assert_text_not_present 'Unknown action'

type "team_name", "SpeedVagen"
click_and_wait("save")
assert_text_present "SpeedVagen"
assert_text_not_present 'error'
assert_text_not_present 'Unknown action'
